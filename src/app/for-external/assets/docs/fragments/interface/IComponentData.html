
<h2>IComponentData</h2>

<p>起始版本：v1.0.0</p>
<p><a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>的数据总体分成两大分支：</p>
<ul>
<li><a href="#/components/api/class/ArrayCollection" target="_self"><code>ArrayCollection</code></a> 这个分支只关注数组类型的集合；</li>
<li><a href="#/components/api/class/GeneralCollection" target="_self"><code>GeneralCollection</code></a> 这个分支只关注通用的key-value结构（即JSON对象）的集合；</li>
</ul>
<p>每个分支下面都派生出许许多多的适合特定场景使用的数据对象，在使用<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>组件的时候，按照自己的场景需要挑选合适的数据对象可以达到事半功倍的效果。</p>
<p>所有可用的数据对象可以查看<a onclick="location.hash = 'relationship'">数据关系图</a>小节。</p>
<h4 id="-">主要数据接口介绍</h4>
<p>本小节主要介绍<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>数据对象中重要的接口，理解这些接口以及每个属性、方法的作用对使用好这些数据对象有着重要的帮助。</p>
<p>主要的接口包括：</p>
<ul>
<li><a href="#/components/api/interface/IComponentData" target="_self"><code>IComponentData</code></a> 这是所有<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>数据接口的根；</li>
<li><a href="#/components/api/interface/IAjaxComponentData" target="_self"><code>IAjaxComponentData</code></a> 实现了这个接口的数据对象都具备访问ajax的能力；</li>
<li><a href="#/components/api/interface/IPageable" target="_self"><code>IPageable</code></a> 实现了这个接口的类都具备分页能力；</li>
<li><a href="#/components/api/interface/IServerSidePageable" target="_self"><code>IServerSidePageable</code></a> 描述了服务端分页的更具体的接口，实现了这个接口的类就具备服务端分页的能力；</li>
<li><a href="#/components/api/interface/ISortable" target="_self"><code>ISortable</code></a> 实现了这个接口的类就具备了数据排序的能力；</li>
<li><a href="#/components/api/interface/IFilterable" target="_self"><code>IFilterable</code></a> 实现了这个接口的类就具备了数据过滤的能力；</li>
<li><a href="#/components/api/interface/ISlicedData" target="_self"><code>ISlicedData</code></a> 实现了这个接口的类就具备切片能力的数据；</li>
</ul>
<h4 id="-">常用数据对象介绍</h4>
<ul>
<li>数组对象<ul>
<li><a href="#/components/api/class/ArrayCollection" target="_self"><code>ArrayCollection</code></a> 一个基础数组对象。</li>
<li><a href="#/components/api/class/PageableArray" target="_self"><code>PageableArray</code></a> 一个支持服务端分页、排序、过滤的数组对象。</li>
<li><a href="#/components/api/class/LocalPageableArray" target="_self"><code>LocalPageableArray</code></a> 一个支持本地分页、排序、过滤的数组对象。</li>
</ul>
</li>
<li>表格数据对象<ul>
<li><a href="#/components/api/class/TableData" target="_self"><code>TableData</code></a> 一个基础的表格数据对象。</li>
<li><a href="#/components/api/class/PageableTableData" target="_self"><code>PageableTableData</code></a> 一个支持服务端分页、排序、过滤的表格数据对象。</li>
<li><a href="#/components/api/class/LocalPageableTableData" target="_self"><code>LocalPageableTableData</code></a> 一个支持本地分页、排序、过滤的表格数据对象。</li>
<li><a href="#/components/api/class/BigTableData" target="_self"><code>BigTableData</code></a> 一个支持海量数据常数级呈现的表格数据对象。</li>
</ul>
</li>
<li>图形数据对象<ul>
<li><a href="#/components/api/class/GraphData" target="_self"><code>GraphData</code></a> 通用的图形数据。</li>
<li><a href="#/components/api/class/PieGraphData" target="_self"><code>PieGraphData</code></a> 通用的饼图数据。</li>
<li><a href="#/components/api/class/PieGraphDataByRow" target="_self"><code>PieGraphDataByRow</code></a> 基于数据库表的行关系生成的饼图。</li>
<li><code>PieGraphDataByColumn</code> 基于数据库表的列关系生成的饼图。</li>
<li><code>LineBarGraphData</code> 通用的折线柱状图数据。</li>
</ul>
</li>
<li>层次关系数据<ul>
<li><a href="#/components/api/class/TreeData" target="_self"><code>TreeData</code></a> 用于有层次关系的组件，包括树、鱼骨图等。</li>
<li><a href="#/components/api/class/SimpleTreeData" target="_self"><code>SimpleTreeData</code></a> 用于简单包装有层次关系的数据，避免<a href="#/components/api/class/TreeData" target="_self"><code>TreeData</code></a>的性能问题。</li>
</ul>
</li>
<li>动态布局数据<ul>
<li><code>LayoutData</code> 用于动态布局页面的数据。</li>
</ul>
</li>
</ul>
<p>目前而言，<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>在数组数据对象和表格数据对象方面的抽象程度较高，已经能够满足绝大部分场景，因此较为稳定。
相对而言，图形数据、层次关系数据这2个方面还比较欠缺，后续需要进一步的抽象和扩展，也难免会引入一些破坏性修改。</p>
<p><a name="relationship"></a></p>
<h4 id="-">数据关系图</h4>
<p>下面这个图描述了<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>的数据对象之间的关系，有点复杂，但是它对理解<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>的数据之间的关系非常有帮助。</p>
<p>提示：单击图上的类名可转到它的api说明页面。</p>
<object type="image/svg+xml" data="/jigsaw/source/docs/image/comp-data-relationship.svg">
</object>

<a name="properties"></a>
<h3>普通属性 / Properties</h3>

<p>无</p>

<a name="methods"></a>
<h3>方法 / Methods</h3>

<table id="dynamicMethods" style="width:100%; display:table">
                <thead><tr><th>名称</th><th>说明</th><th>返回值</th><th>参数说明</th><th>示例</th></tr></thead>
                <tbody><tr style="display:table-row; background-color:#fff"><td style="white-space: nowrap;"><a style="position:relative;top:-10px;left:-16px;text-decoration:none;cursor:default;" name="destroy">&nbsp;</a><span class="iconfont iconfont-ea49" style="color: green; margin-right: 4px" title="Public"></span>destroy</td><td><p>数据销毁时要做的事情，往往由<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>的各个组件使用，应用一般无需调用此方法。</p>
</td>
            <td><p style="white-space: nowrap;">返回类型 <a href="https://www.tslang.cn/docs/handbook/basic-types.html" target="_blank">void</a></p></td><td>--</td><td></td></tr><tr style="display:table-row; background-color:#f8f8f8"><td style="white-space: nowrap;"><a style="position:relative;top:-10px;left:-16px;text-decoration:none;cursor:default;" name="onChange">&nbsp;</a><span class="iconfont iconfont-ea49" style="color: green; margin-right: 4px" title="Public"></span>onChange</td><td><p>注册数据有变化时的处理逻辑，仅在外部更新数据时触发回调，排序、过滤、分页等动作不会触发回调
往往由<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>的各个组件使用，应用一般无需调用此方法。</p>
</td>
            <td><p style="white-space: nowrap;">返回类型 <a href="#/components/api/typealias/CallbackRemoval" target="_self">CallbackRemoval</a></p></td><td><ul><li><span style="white-space: nowrap;">callback: <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank">function</a></span></li><li><span style="white-space: nowrap;">context<span style="margin:0 2px 0 2px; color:#009688" title="Optional" class="iconfont iconfont-e9ef"></span>: <a href="https://www.tslang.cn/docs/handbook/basic-types.html" target="_blank">any</a></span></li></ul></td><td></td></tr><tr style="display:table-row; background-color:#fff"><td style="white-space: nowrap;"><a style="position:relative;top:-10px;left:-16px;text-decoration:none;cursor:default;" name="onRefresh">&nbsp;</a><span class="iconfont iconfont-ea49" style="color: green; margin-right: 4px" title="Public"></span>onRefresh</td><td><p>注册数据有更新时的处理逻辑，在外部更新数据、排序、过滤、分页等动作，都会触发回调。
往往由<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>的各个组件使用，应用一般无需调用此方法。</p>
</td>
            <td><p style="white-space: nowrap;">返回类型 <a href="#/components/api/typealias/CallbackRemoval" target="_self">CallbackRemoval</a></p></td><td><ul><li><span style="white-space: nowrap;">callback: <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank">function</a></span></li><li><span style="white-space: nowrap;">context<span style="margin:0 2px 0 2px; color:#009688" title="Optional" class="iconfont iconfont-e9ef"></span>: <a href="https://www.tslang.cn/docs/handbook/basic-types.html" target="_blank">any</a></span></li></ul></td><td></td></tr><tr style="display:table-row; background-color:#f8f8f8"><td style="white-space: nowrap;"><a style="position:relative;top:-10px;left:-16px;text-decoration:none;cursor:default;" name="refresh">&nbsp;</a><span class="iconfont iconfont-ea49" style="color: green; margin-right: 4px" title="Public"></span>refresh</td><td><p>Angular的变化检测机制无法检测到我们对一个对象的某个属性所做的修改，例如我们将一个数组通过输入属性的方式绑定给了一个组件之后，
直接在这个数组中插入一个元素，组件内部是难以获知这个变化的。<a href="#/components/api/interface/IComponentData#refresh" target="_self"><code>refresh()</code></a>这个方法就是为了解决这个问题而存在的，
当你更新了数据之后，请务必调用一下这个方法以通知组件及时更新。</p>
<p><strong>这是<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>向性能妥协后的产物。</strong></p>
<p>我们都知道，Angular里没有了脏检查了，性能提升了没错，但是Angular开发团队却把问题留给了我们，组件内部只能感知到对象引用的变化，
而无法感知到对象内部结构的变化。换句话说，应用直接修改复杂对象的内部结构的行为是没有高效的方式可以感知到的。
因此他们也就无法采用最低廉的方式给<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>发出通知，而<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>在这个情况下也就无法及时更新视图了。</p>
<p>那为啥说这是向性能妥协的产物呢？前面我说了，angular是难以感知到对象的内部结构的变化，但是这不意味着angular做不到，
实际上是能够做到的，通过<a href="https://angular.io/api/core/DoCheck" target="_blank"><code>DoCheck</code></a>这个钩子，可以检测到任何变化，在这个钩子里，通过一些复杂的代码，是可以精确的筛选出这个变化的。
但是这个事情的性能代价是非常昂贵，在IE11这个搓货上，体验会很差。经过相当长的纠结之后，我们决定放弃自动检测，
和Angular团队一样，把问题丢给应用，<strong>由应用在修改了对象内部结构后，通过<a href="#/components/api/interface/IComponentData#refresh" target="_self"><code>refresh()</code></a>方法来通知<a href="https://github.com/rdkmaster/jigsaw" title="请帮忙到GitHub上点个星星，更多的星星可以吸引越多的人加入我们。">Jigsaw</a>更新视图</strong>。</p>
<p></p>
</td>
            <td><p style="white-space: nowrap;">返回类型 <a href="https://www.tslang.cn/docs/handbook/basic-types.html" target="_blank">void</a></p></td><td>--</td><td><ul><li title=""><a onclick="document.getElementById('panel').style.display = 'block';
            const evalator = document.getElementById('evalator');
            if (evalator.src != location.host + 'jigsaw-demo/#/pc/data-encapsulation/refresh') evalator.src = 'jigsaw-demo/#/pc/data-encapsulation/refresh';">refresh</a></li></li></ul></td></tr></tbody>
            </table>





<a name="object-oriented"></a>
<h3>面向对象 / Object Oriented</h3>
<ul><li>继承关系 --</li><li>实现接口 --</li><li>已知子类 <a href="#/components/api/interface/IAjaxComponentData" target="_self">IAjaxComponentData</a> / <a href="#/components/api/interface/IFilterable" target="_self">IFilterable</a> / <a href="#/components/api/interface/IPageable" target="_self">IPageable</a> / <a href="#/components/api/interface/IServerSidePageable" target="_self">IServerSidePageable</a> / <a href="#/components/api/interface/ISlicedData" target="_self">ISlicedData</a> / <a href="#/components/api/interface/ISortable" target="_self">ISortable</a></li></ul>

<div id="panel" class="api-panel">
    <div class="box">
        <span class="close" title="返回"
              onclick="document.getElementById('panel').style.display = 'none';">&times;</span>
        <iframe id="evalator"></iframe>
    </div>
</div>
